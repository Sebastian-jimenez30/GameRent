{% extends 'base.html' %}
{% load static %}

{% block content %}
<h2>🎮 Mi Biblioteca</h2>

<h3>🛒 Juegos Comprados</h3>
<div class="row">
  {% for game in purchased_games %}
    <div class="col-md-4">
      <div class="card mb-3 border-success">
        <div class="card-body">
          <h5 class="card-title">{{ game.title }}</h5>
          <p class="card-text">Desarrollador: {{ game.developer }}</p>
          <button type="submit" class="btn btn-outline-success btn-sm">Descargar</button>
        </div>
      </div>
    </div>
  {% empty %}
    <p>No has comprado juegos aún.</p>
  {% endfor %}
</div>

<h3>📦 Juegos Rentados</h3>
<div class="row">
  {% for game in rented_games %}
    <div class="col-md-4">
      <div class="card mb-3">
        <div class="card-body">
          <h5 class="card-title">{{ game.title }}</h5>
          <p class="card-text">Desarrollador: {{ game.developer }}</p>
        </div>
      </div>
    </div>
  {% empty %}
    <p>No has rentado juegos aún.</p>
  {% endfor %}
</div>

<h3>🤝 Juegos Rentados Compartidos</h3>
<div class="row">
  {% for shared_rental in available_shared_rentals %}
    <div class="col-md-4">
      <div class="card mb-3 border-success">
        <div class="card-body">
          <h5 class="card-title">{{ shared_rental.game.title }}</h5>
          <p class="card-text">Desarrollador: {{ shared_rental.game.developer }}</p>
          <p class="text-success">✅ Disponible para descarga (todos han pagado)</p>
          <button type="submit" class="btn btn-outline-success btn-sm">Descargar</button>
        </div>
      </div>
    </div>
  {% endfor %}

  {% for shared_rental in unavailable_shared_rentals %}
  <div class="col-md-4">
    <div class="card mb-3 border-danger">
      <div class="card-body">
        <h5 class="card-title">{{ shared_rental.game.title }}</h5>
        <p class="card-text">Desarrollador: {{ shared_rental.game.developer }}</p>
        <p class="text-danger">❌ No disponible (hay pagos pendientes)</p>
        <a class="btn btn-outline-danger btn-sm" href="{% url 'shared_rental_details' pk=shared_rental.id %}">
          Ver detalles
        </a>
      </div>
    </div>
  </div>
  {% endfor %}

  {% if available_shared_rentals|length == 0 and unavailable_shared_rentals|length == 0 %}
    <p>No tienes juegos rentados compartidos aún.</p>
  {% endif %}
</div>
{% endblock %}

